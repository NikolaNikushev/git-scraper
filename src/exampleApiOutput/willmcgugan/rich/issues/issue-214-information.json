{"url":"https://api.github.com/repos/willmcgugan/rich/issues/214","repository_url":"https://api.github.com/repos/willmcgugan/rich","labels_url":"https://api.github.com/repos/willmcgugan/rich/issues/214/labels{/name}","comments_url":"https://api.github.com/repos/willmcgugan/rich/issues/214/comments","events_url":"https://api.github.com/repos/willmcgugan/rich/issues/214/events","html_url":"https://github.com/willmcgugan/rich/issues/214","id":674217382,"node_id":"MDU6SXNzdWU2NzQyMTczODI=","number":214,"title":"[REQUEST] Scoping of Tracebacks","user":{"login":"mbarkhau","id":446561,"node_id":"MDQ6VXNlcjQ0NjU2MQ==","avatar_url":"https://avatars0.githubusercontent.com/u/446561?v=4","gravatar_id":"","url":"https://api.github.com/users/mbarkhau","html_url":"https://github.com/mbarkhau","followers_url":"https://api.github.com/users/mbarkhau/followers","following_url":"https://api.github.com/users/mbarkhau/following{/other_user}","gists_url":"https://api.github.com/users/mbarkhau/gists{/gist_id}","starred_url":"https://api.github.com/users/mbarkhau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mbarkhau/subscriptions","organizations_url":"https://api.github.com/users/mbarkhau/orgs","repos_url":"https://api.github.com/users/mbarkhau/repos","events_url":"https://api.github.com/users/mbarkhau/events{/privacy}","received_events_url":"https://api.github.com/users/mbarkhau/received_events","type":"User","site_admin":false},"labels":[{"id":2200581776,"node_id":"MDU6TGFiZWwyMjAwNTgxNzc2","url":"https://api.github.com/repos/willmcgugan/rich/labels/Needs%20triage","name":"Needs triage","color":"bfdadc","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2020-08-06T10:46:40Z","updated_at":"2020-08-08T11:11:08Z","closed_at":"2020-08-06T11:01:27Z","author_association":"NONE","active_lock_reason":null,"body":"I would like to suggest a different way to format tracebacks, which makes use of the virtualenv and project structure. Here is an example of what I'm thinking of.\r\n\r\n```python\r\nFile \"/home/mbarkhau/miniconda3/envs/litprog_py38/bin/litprog\", line 12, in <module> 12     sys.exit(cli())\r\n\r\nDirectory \"/home/mbarkhau/miniconda3/envs/litprog_py38/lib/python3.8/site-packages/\"\r\nFile \"click/core.py\", line    829, in __call__      return self.main(*args, **kwargs)\r\nFile \"click/core.py\", line    782, in main          rv = self.invoke(ctx)\r\nFile \"click/core.py\", line   1259, in invoke        return _process_result(sub_ctx.command.invoke(sub_ctx))\r\nFile \"click/core.py\", line   1066, in invoke        return ctx.invoke(self.callback, **ctx.params)\r\nFile \"click/core.py\", line    610, in invoke        return callback(*args, **kwargs)\r\n\r\nDirectory \"/home/mbarkhau/foss/litprog/\"\r\nFile \"src/litprog/cli.py\",      line 160, in build              lp_gen_docs.gen_html(built_ctx, html_dir)\r\nFile \"src/litprog/gen_docs.py\", line 294, in gen_html           wrapped_html = wrap_content_html(content_html, 'screen', meta, toc)\r\nFile \"src/litprog/gen_docs.py\", line 237, in wrap_content_html  result = tmpl.render(**ctx)\r\n\r\nDirectory \"/home/mbarkhau/miniconda3/envs/litprog_py38/lib/python3.8/site-packages/\"\r\nFile \"jinja2/environment.py\", line 1090, in render              self.environment.handle_exception()\r\nFile \"jinja2/environment.py\", line  832, in handle_exception    reraise(*rewrite_traceback_stack(source=source))\r\nFile \"jinja2/_compat.py\",     line   28, in reraise             raise value.with_traceback(tb)\r\n\r\nFile \"<template>\", line   56, in top-level template code\r\n```\r\n\r\nUsually the error is in the project code rather than in libraries, so I think it makes sense to group the traceback accordingly. During development I can also use a wide terminal and avoid interleaving different kinds of data (filepath, source text, filepath) and instead present it in a more tabular form. There are less lines of source in that case, but I'm not so sad about that. I think the main thing to help a dev identify is that the issue in this case is in `wrap_content_html` of \"src/litprog/gen_docs.py\", line 237 and everything apart from that, to a first approximation, is noise.\r\n\r\nThe two directories that I think are relevant to use as a cutoff are, `site-packages` and the `$PWD`.","closed_by":{"login":"mbarkhau","id":446561,"node_id":"MDQ6VXNlcjQ0NjU2MQ==","avatar_url":"https://avatars0.githubusercontent.com/u/446561?v=4","gravatar_id":"","url":"https://api.github.com/users/mbarkhau","html_url":"https://github.com/mbarkhau","followers_url":"https://api.github.com/users/mbarkhau/followers","following_url":"https://api.github.com/users/mbarkhau/following{/other_user}","gists_url":"https://api.github.com/users/mbarkhau/gists{/gist_id}","starred_url":"https://api.github.com/users/mbarkhau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mbarkhau/subscriptions","organizations_url":"https://api.github.com/users/mbarkhau/orgs","repos_url":"https://api.github.com/users/mbarkhau/repos","events_url":"https://api.github.com/users/mbarkhau/events{/privacy}","received_events_url":"https://api.github.com/users/mbarkhau/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
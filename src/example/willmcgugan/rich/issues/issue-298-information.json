{"url":"https://api.github.com/repos/willmcgugan/rich/issues/298","repository_url":"https://api.github.com/repos/willmcgugan/rich","labels_url":"https://api.github.com/repos/willmcgugan/rich/issues/298/labels{/name}","comments_url":"https://api.github.com/repos/willmcgugan/rich/issues/298/comments","events_url":"https://api.github.com/repos/willmcgugan/rich/issues/298/events","html_url":"https://github.com/willmcgugan/rich/issues/298","id":705832186,"node_id":"MDU6SXNzdWU3MDU4MzIxODY=","number":298,"title":"[REQUEST] Adding rich tracebacks support to RichHandler","user":{"login":"taliraj","id":3104974,"node_id":"MDQ6VXNlcjMxMDQ5NzQ=","avatar_url":"https://avatars1.githubusercontent.com/u/3104974?v=4","gravatar_id":"","url":"https://api.github.com/users/taliraj","html_url":"https://github.com/taliraj","followers_url":"https://api.github.com/users/taliraj/followers","following_url":"https://api.github.com/users/taliraj/following{/other_user}","gists_url":"https://api.github.com/users/taliraj/gists{/gist_id}","starred_url":"https://api.github.com/users/taliraj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/taliraj/subscriptions","organizations_url":"https://api.github.com/users/taliraj/orgs","repos_url":"https://api.github.com/users/taliraj/repos","events_url":"https://api.github.com/users/taliraj/events{/privacy}","received_events_url":"https://api.github.com/users/taliraj/received_events","type":"User","site_admin":false},"labels":[{"id":2200581776,"node_id":"MDU6TGFiZWwyMjAwNTgxNzc2","url":"https://api.github.com/repos/willmcgugan/rich/labels/Needs%20triage","name":"Needs triage","color":"bfdadc","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2020-09-21T18:46:47Z","updated_at":"2020-09-25T14:50:44Z","closed_at":"2020-09-25T14:50:44Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Hi, I would like to contribute to rich with the following feature.\r\nI am opening this issue in order to discuss the details of the implementation with the maintainers.\r\n\r\nI want to modify RichHandler in order to use `print_exception` in case of exceptions.\r\nIt means that calls to `logger.exception()` would display rich tracebacks, and uncaught exceptions in django would also display rich tracebacks.\r\nThis is how it would look with django:\r\n\r\n<pre>System check identified no issues (0 silenced).\r\nSeptember 21, 2020 - 18:09:32\r\nDjango version 3.1.1, using settings &apos;dj.settings&apos;\r\nStarting development server at http://127.0.0.1:8000/\r\nQuit the server with CONTROL-C.\r\n<font color=\"#116171\">[18:09:48] </font><font color=\"#AA0000\">WARNING</font>  Not Found: <font color=\"#AA22AA\">/</font>                                                                                                                                                                                                                                     log.py:224\r\n<font color=\"#116171\">           </font><font color=\"#AA0000\">WARNING</font>  <font color=\"#44AA44\">&quot;</font><font color=\"#DED82C\"><b>GET</b></font><font color=\"#44AA44\"> / HTTP/1.1&quot;</font> <font color=\"#295FCC\"><b>404</b></font> <font color=\"#295FCC\"><b>2023</b></font>                                                                                                                                                                                                                   basehttp.py:157\r\n<font color=\"#116171\">[18:09:55] </font><font color=\"#AA0000\">WARNING</font>  Not Found: <font color=\"#AA22AA\">/</font>                                                                                                                                                                                                                                     log.py:224\r\n<font color=\"#116171\">           </font><font color=\"#AA0000\">WARNING</font>  <font color=\"#44AA44\">&quot;</font><font color=\"#DED82C\"><b>GET</b></font><font color=\"#44AA44\"> / HTTP/1.1&quot;</font> <font color=\"#295FCC\"><b>404</b></font> <font color=\"#295FCC\"><b>2023</b></font>                                                                                                                                                                                                                   basehttp.py:157\r\n<font color=\"#FFFFFF\"><b>Traceback</b></font> (most recent call last):\r\n<font color=\"#0039AA\">╭──────────────────────────────────────────────────────────────────────────────────────╮</font>\r\n<font color=\"#0039AA\">│ File </font><font color=\"#44AA44\">&quot;/home/landi/Documents/dj_apps/django_traceback/env/lib/python3.8/site-packages/</font><font color=\"#0039AA\">│</font>\r\n<font color=\"#0039AA\">│</font><font color=\"#2D712D\">django/core/handlers/exception.py&quot;</font><font color=\"#0039AA\">, line </font><font color=\"#4CCCE6\"><b>47</b></font><font color=\"#0039AA\">, in </font><font color=\"#AA5500\">inner</font><font color=\"#0039AA\">                                 │</font>\r\n<font color=\"#0039AA\">│  </font><span style=\"background-color:#272822\"><font color=\"#E3E3DD\"><b>  </b></font></span><span style=\"background-color:#272822\"><font color=\"#656660\"> 44 </font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\">        </font></span><span style=\"background-color:#272822\"><font color=\"#A6E22E\">@wraps</font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\">(get_response)</font></span><span style=\"background-color:#272822\"><font color=\"#0039AA\">                                                  </font></span><font color=\"#0039AA\">│</font>\r\n<font color=\"#0039AA\">│  </font><span style=\"background-color:#272822\"><font color=\"#E3E3DD\"><b>  </b></font></span><span style=\"background-color:#272822\"><font color=\"#656660\"> 45 </font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\">        </font></span><span style=\"background-color:#272822\"><font color=\"#66D9EF\">def</font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\"> </font></span><span style=\"background-color:#272822\"><font color=\"#A6E22E\">inner</font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\">(request):</font></span><span style=\"background-color:#272822\"><font color=\"#0039AA\">                                                   </font></span><font color=\"#0039AA\">│</font>\r\n<font color=\"#0039AA\">│  </font><span style=\"background-color:#272822\"><font color=\"#E3E3DD\"><b>  </b></font></span><span style=\"background-color:#272822\"><font color=\"#656660\"> 46 </font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\">            </font></span><span style=\"background-color:#272822\"><font color=\"#66D9EF\">try</font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\">:</font></span><span style=\"background-color:#272822\"><font color=\"#0039AA\">                                                              </font></span><font color=\"#0039AA\">│</font>\r\n<font color=\"#0039AA\">│  </font><span style=\"background-color:#272822\"><font color=\"#656660\">❱ </font></span><span style=\"background-color:#272822\"><font color=\"#E3E3DD\"><b> 47 </b></font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\">                response </font></span><span style=\"background-color:#272822\"><font color=\"#F92672\">=</font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\"> get_response(request)</font></span><span style=\"background-color:#272822\"><font color=\"#0039AA\">                              </font></span><font color=\"#0039AA\">│</font>\r\n<font color=\"#0039AA\">│  </font><span style=\"background-color:#272822\"><font color=\"#E3E3DD\"><b>  </b></font></span><span style=\"background-color:#272822\"><font color=\"#656660\"> 48 </font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\">            </font></span><span style=\"background-color:#272822\"><font color=\"#66D9EF\">except</font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\"> </font></span><span style=\"background-color:#272822\"><font color=\"#A6E22E\">Exception</font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\"> </font></span><span style=\"background-color:#272822\"><font color=\"#66D9EF\">as</font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\"> exc:</font></span><span style=\"background-color:#272822\"><font color=\"#0039AA\">                                          </font></span><font color=\"#0039AA\">│</font>\r\n<font color=\"#0039AA\">│  </font><span style=\"background-color:#272822\"><font color=\"#E3E3DD\"><b>  </b></font></span><span style=\"background-color:#272822\"><font color=\"#656660\"> 49 </font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\">                response </font></span><span style=\"background-color:#272822\"><font color=\"#F92672\">=</font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\"> response_for_exception(request, exc)</font></span><span style=\"background-color:#272822\"><font color=\"#0039AA\">               </font></span><font color=\"#0039AA\">│</font>\r\n<font color=\"#0039AA\">│  </font><span style=\"background-color:#272822\"><font color=\"#E3E3DD\"><b>  </b></font></span><span style=\"background-color:#272822\"><font color=\"#656660\"> 50 </font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\">            </font></span><span style=\"background-color:#272822\"><font color=\"#66D9EF\">return</font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\"> response</font></span><span style=\"background-color:#272822\"><font color=\"#0039AA\">                                                   </font></span><font color=\"#0039AA\">│</font>\r\n<font color=\"#0039AA\">│ File </font><font color=\"#44AA44\">&quot;/home/landi/Documents/dj_apps/django_traceback/env/lib/python3.8/site-packages/</font><font color=\"#0039AA\">│</font>\r\n<font color=\"#0039AA\">│</font><font color=\"#2D712D\">django/core/handlers/base.py&quot;</font><font color=\"#0039AA\">, line </font><font color=\"#4CCCE6\"><b>179</b></font><font color=\"#0039AA\">, in </font><font color=\"#AA5500\">_get_response</font><font color=\"#0039AA\">                             │</font>\r\n<font color=\"#0039AA\">│  </font><span style=\"background-color:#272822\"><font color=\"#E3E3DD\"><b>  </b></font></span><span style=\"background-color:#272822\"><font color=\"#656660\">176 </font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\">            </font></span><span style=\"background-color:#272822\"><font color=\"#66D9EF\">if</font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\"> asyncio</font></span><span style=\"background-color:#272822\"><font color=\"#F92672\">.</font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\">iscoroutinefunction(wrapped_callback):</font></span><span style=\"background-color:#272822\"><font color=\"#0039AA\">                 </font></span><font color=\"#0039AA\">│</font>\r\n<font color=\"#0039AA\">│  </font><span style=\"background-color:#272822\"><font color=\"#E3E3DD\"><b>  </b></font></span><span style=\"background-color:#272822\"><font color=\"#656660\">177 </font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\">                wrapped_callback </font></span><span style=\"background-color:#272822\"><font color=\"#F92672\">=</font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\"> async_to_sync(wrapped_callback)</font></span><span style=\"background-color:#272822\"><font color=\"#0039AA\">            </font></span><font color=\"#0039AA\">│</font>\r\n<font color=\"#0039AA\">│  </font><span style=\"background-color:#272822\"><font color=\"#E3E3DD\"><b>  </b></font></span><span style=\"background-color:#272822\"><font color=\"#656660\">178 </font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\">            </font></span><span style=\"background-color:#272822\"><font color=\"#66D9EF\">try</font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\">:</font></span><span style=\"background-color:#272822\"><font color=\"#0039AA\">                                                              </font></span><font color=\"#0039AA\">│</font>\r\n<font color=\"#0039AA\">│  </font><span style=\"background-color:#272822\"><font color=\"#656660\">❱ </font></span><span style=\"background-color:#272822\"><font color=\"#E3E3DD\"><b>179 </b></font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\">                response </font></span><span style=\"background-color:#272822\"><font color=\"#F92672\">=</font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\"> wrapped_callback(request, </font></span><span style=\"background-color:#272822\"><font color=\"#F92672\">*</font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\">callback_args, </font></span><span style=\"background-color:#272822\"><font color=\"#F92672\">**</font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\">callbac</font></span><font color=\"#0039AA\">│</font>\r\n<font color=\"#0039AA\">│  </font><span style=\"background-color:#272822\"><font color=\"#E3E3DD\"><b>  </b></font></span><span style=\"background-color:#272822\"><font color=\"#656660\">180 </font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\">            </font></span><span style=\"background-color:#272822\"><font color=\"#66D9EF\">except</font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\"> </font></span><span style=\"background-color:#272822\"><font color=\"#A6E22E\">Exception</font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\"> </font></span><span style=\"background-color:#272822\"><font color=\"#66D9EF\">as</font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\"> e:</font></span><span style=\"background-color:#272822\"><font color=\"#0039AA\">                                            </font></span><font color=\"#0039AA\">│</font>\r\n<font color=\"#0039AA\">│  </font><span style=\"background-color:#272822\"><font color=\"#E3E3DD\"><b>  </b></font></span><span style=\"background-color:#272822\"><font color=\"#656660\">181 </font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\">                response </font></span><span style=\"background-color:#272822\"><font color=\"#F92672\">=</font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\"> self</font></span><span style=\"background-color:#272822\"><font color=\"#F92672\">.</font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\">process_exception_by_middleware(e, request)</font></span><span style=\"background-color:#272822\"><font color=\"#0039AA\">   </font></span><font color=\"#0039AA\">│</font>\r\n<font color=\"#0039AA\">│  </font><span style=\"background-color:#272822\"><font color=\"#E3E3DD\"><b>  </b></font></span><span style=\"background-color:#272822\"><font color=\"#656660\">182 </font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\">                </font></span><span style=\"background-color:#272822\"><font color=\"#66D9EF\">if</font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\"> response </font></span><span style=\"background-color:#272822\"><font color=\"#F92672\">is</font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\"> </font></span><span style=\"background-color:#272822\"><font color=\"#66D9EF\">None</font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\">:</font></span><span style=\"background-color:#272822\"><font color=\"#0039AA\">                                          </font></span><font color=\"#0039AA\">│</font>\r\n<font color=\"#0039AA\">│ File </font><font color=\"#44AA44\">&quot;/home/landi/Documents/dj_apps/django_traceback/trc/views.py&quot;</font><font color=\"#0039AA\">, line </font><font color=\"#4CCCE6\"><b>6</b></font><font color=\"#0039AA\">, in </font><font color=\"#AA5500\">index</font><font color=\"#0039AA\"> │</font>\r\n<font color=\"#0039AA\">│  </font><span style=\"background-color:#272822\"><font color=\"#E3E3DD\"><b>  </b></font></span><span style=\"background-color:#272822\"><font color=\"#656660\">3 </font></span><span style=\"background-color:#272822\"><font color=\"#0039AA\">                                                                                </font></span><font color=\"#0039AA\">│</font>\r\n<font color=\"#0039AA\">│  </font><span style=\"background-color:#272822\"><font color=\"#E3E3DD\"><b>  </b></font></span><span style=\"background-color:#272822\"><font color=\"#656660\">4 </font></span><span style=\"background-color:#272822\"><font color=\"#0039AA\">                                                                                </font></span><font color=\"#0039AA\">│</font>\r\n<font color=\"#0039AA\">│  </font><span style=\"background-color:#272822\"><font color=\"#E3E3DD\"><b>  </b></font></span><span style=\"background-color:#272822\"><font color=\"#656660\">5 </font></span><span style=\"background-color:#272822\"><font color=\"#66D9EF\">def</font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\"> </font></span><span style=\"background-color:#272822\"><font color=\"#A6E22E\">index</font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\">(request):</font></span><span style=\"background-color:#272822\"><font color=\"#0039AA\">                                                             </font></span><font color=\"#0039AA\">│</font>\r\n<font color=\"#0039AA\">│  </font><span style=\"background-color:#272822\"><font color=\"#656660\">❱ </font></span><span style=\"background-color:#272822\"><font color=\"#E3E3DD\"><b>6 </b></font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\">    x </font></span><span style=\"background-color:#272822\"><font color=\"#F92672\">=</font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\"> </font></span><span style=\"background-color:#272822\"><font color=\"#AE81FF\">1</font></span><span style=\"background-color:#272822\"><font color=\"#F92672\">/</font></span><span style=\"background-color:#272822\"><font color=\"#AE81FF\">0</font></span><span style=\"background-color:#272822\"><font color=\"#0039AA\">                                                                     </font></span><font color=\"#0039AA\">│</font>\r\n<font color=\"#0039AA\">│  </font><span style=\"background-color:#272822\"><font color=\"#E3E3DD\"><b>  </b></font></span><span style=\"background-color:#272822\"><font color=\"#656660\">7 </font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\">    </font></span><span style=\"background-color:#272822\"><font color=\"#66D9EF\">return</font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\"> HttpResponse(</font></span><span style=\"background-color:#272822\"><font color=\"#E6DB74\">&quot;Hello, world.&quot;</font></span><span style=\"background-color:#272822\"><font color=\"#F8F8F2\">)</font></span><span style=\"background-color:#272822\"><font color=\"#0039AA\">                                        </font></span><font color=\"#0039AA\">│</font>\r\n<font color=\"#0039AA\">╰──────────────────────────────────────────────────────────────────────────────────────╯</font>\r\n<font color=\"#FF8787\"><b>ZeroDivisionError: </b></font>division by zero\r\n<font color=\"#116171\">[18:10:02] </font><font color=\"#FF8787\"><b>ERROR</b></font>    <font color=\"#44AA44\">&quot;</font><font color=\"#DED82C\"><b>GET</b></font><font color=\"#44AA44\"> /polls/ HTTP/1.1&quot;</font> <font color=\"#295FCC\"><b>500</b></font> <font color=\"#295FCC\"><b>62138</b></font>                                              </pre>\r\n\r\n\r\n\r\nThus, I am going to add 5 more parameters to RichHandler, four of which are the optional parameters of `print_exception`: `width`, `extra_lines`, `theme`, `word_wrap`. The other one will be used to enable or disable traceback handling, and I am going to call it `handle_tracebacks,` and perhaps give it a default value of `False.`\r\n\r\nPlease feel free to give me any feadback/suggestion or thought about it while I am working on a Pull Request.","closed_by":{"login":"taliraj","id":3104974,"node_id":"MDQ6VXNlcjMxMDQ5NzQ=","avatar_url":"https://avatars1.githubusercontent.com/u/3104974?v=4","gravatar_id":"","url":"https://api.github.com/users/taliraj","html_url":"https://github.com/taliraj","followers_url":"https://api.github.com/users/taliraj/followers","following_url":"https://api.github.com/users/taliraj/following{/other_user}","gists_url":"https://api.github.com/users/taliraj/gists{/gist_id}","starred_url":"https://api.github.com/users/taliraj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/taliraj/subscriptions","organizations_url":"https://api.github.com/users/taliraj/orgs","repos_url":"https://api.github.com/users/taliraj/repos","events_url":"https://api.github.com/users/taliraj/events{/privacy}","received_events_url":"https://api.github.com/users/taliraj/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
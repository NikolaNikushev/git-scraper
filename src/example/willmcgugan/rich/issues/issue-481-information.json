{"url":"https://api.github.com/repos/willmcgugan/rich/issues/481","repository_url":"https://api.github.com/repos/willmcgugan/rich","labels_url":"https://api.github.com/repos/willmcgugan/rich/issues/481/labels{/name}","comments_url":"https://api.github.com/repos/willmcgugan/rich/issues/481/comments","events_url":"https://api.github.com/repos/willmcgugan/rich/issues/481/events","html_url":"https://github.com/willmcgugan/rich/issues/481","id":763477487,"node_id":"MDU6SXNzdWU3NjM0Nzc0ODc=","number":481,"title":"[QUESTION] Progress calss out of context manager","user":{"login":"nicofirst1","id":17785441,"node_id":"MDQ6VXNlcjE3Nzg1NDQx","avatar_url":"https://avatars0.githubusercontent.com/u/17785441?v=4","gravatar_id":"","url":"https://api.github.com/users/nicofirst1","html_url":"https://github.com/nicofirst1","followers_url":"https://api.github.com/users/nicofirst1/followers","following_url":"https://api.github.com/users/nicofirst1/following{/other_user}","gists_url":"https://api.github.com/users/nicofirst1/gists{/gist_id}","starred_url":"https://api.github.com/users/nicofirst1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicofirst1/subscriptions","organizations_url":"https://api.github.com/users/nicofirst1/orgs","repos_url":"https://api.github.com/users/nicofirst1/repos","events_url":"https://api.github.com/users/nicofirst1/events{/privacy}","received_events_url":"https://api.github.com/users/nicofirst1/received_events","type":"User","site_admin":false},"labels":[{"id":2200581776,"node_id":"MDU6TGFiZWwyMjAwNTgxNzc2","url":"https://api.github.com/repos/willmcgugan/rich/labels/Needs%20triage","name":"Needs triage","color":"bfdadc","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":10,"created_at":"2020-12-12T09:03:18Z","updated_at":"2020-12-12T11:40:34Z","closed_at":"2020-12-12T11:37:32Z","author_association":"NONE","active_lock_reason":null,"body":"I'm trying to print the progress of a deep model training.\r\nSince I cannot directly modify the training loop I need to use a class `CustomLogger` method which is called at each iteration. \r\nThis class stores the total length `train_data_len` of the loop and the called method  `on_batch_end`.\r\nI would like to define a progress class attribute and update it everytime the method is called, like the following:\r\n\r\n```\r\n\r\nclass CustomLogger(Callback):\r\n    def __init__(\r\n        self, train_data_len=None, eval_data_len=None, logging_step=50\r\n    ):\r\n\r\n        self.train_data_len = train_data_len\r\n        self.eval_data_len = eval_data_len\r\n        # define the progress class and add train and eval\r\n        self.progress = Progress()\r\n        self.train_p = self.progress.add_task(\"Train\", total=self.train_data_len)\r\n        self.eval_p = self.progress.add_task(\"Eval\", total=self.eval_data_len)\r\n\r\n\r\n    def on_epoch_end(self, loss: float, logs: Interaction, epoch: int):\r\n        # at the end of the epoch reset the tasks progress\r\n        self.train_p.reset(total=self.train_data_len)\r\n        self.eval_p.reset(total=self.eval_data_len)\r\n\r\n     # called on every loop iteration\r\n    def on_batch_end(\r\n        self, logs: Interaction, loss: float, batch_id: int, is_training: bool\r\n    ): \r\n        # update the relative task \r\n            if is_training:\r\n                self.progress.update(self.train_p, advance=1)\r\n            else:\r\n                self.progress.update(self.eval_p, advance=1)\r\n\r\n```","closed_by":{"login":"nicofirst1","id":17785441,"node_id":"MDQ6VXNlcjE3Nzg1NDQx","avatar_url":"https://avatars0.githubusercontent.com/u/17785441?v=4","gravatar_id":"","url":"https://api.github.com/users/nicofirst1","html_url":"https://github.com/nicofirst1","followers_url":"https://api.github.com/users/nicofirst1/followers","following_url":"https://api.github.com/users/nicofirst1/following{/other_user}","gists_url":"https://api.github.com/users/nicofirst1/gists{/gist_id}","starred_url":"https://api.github.com/users/nicofirst1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicofirst1/subscriptions","organizations_url":"https://api.github.com/users/nicofirst1/orgs","repos_url":"https://api.github.com/users/nicofirst1/repos","events_url":"https://api.github.com/users/nicofirst1/events{/privacy}","received_events_url":"https://api.github.com/users/nicofirst1/received_events","type":"User","site_admin":false},"performed_via_github_app":null}